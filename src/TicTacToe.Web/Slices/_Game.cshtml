@inherits RazorSlice<(Guid Id, Engine.Game Game)>

<div>
    <div id="board-@(Model.Id)" class="game-board">
        @for (byte row = 0; row < 3; row++)
        {
            @for (byte col = 0; col < 3; col++)
            {
                var position = Engine.Position.At(row, col);
                var marker = Model.Board[row * 3 + col];
                <div class="cell">
                    @if (marker.HasValue)
                    {
                        @marker.Value.ToString()
                    }
                    else if (!Model.IsComplete)
                    {
                        <div
                            class="cell"
                            data-on-click="@@post('/game/@(Model.Id)')"
                            data-params='{ "position": @(row * 3 + col), "marker": "@(Model.Game.GetCurrentPlayer)" }'>
                            &nbsp;
                        </div>
                    }
                </div>
            }
        }
    </div>

    <div style="margin-top: 1em;">
        @if (Model.IsComplete)
        {
            @if (Model.Winner.HasValue)
            {
                <p>Game Over! @Model.Winner.Value wins!</p>
            }
            else
            {
                <p>Game Over! It's a draw!</p>
            }
            <a href="/" data-on-click="@@navigate">Back to Games</a>
        }
        else
        {
            <p>Current Player: @(Model.Game.GetCurrentPlayer())</p>
        }
    </div>
</div>
